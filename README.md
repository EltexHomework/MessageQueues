# Задание 13 - Очереди сообщений 
## Сборщик проекта
В качестве сборщика проекта используется Makefile. Для компиляции проекта необходимо ввести следующую команду в корне проекта:
``` bash
make
```

Для очистки бинарных файлов можно воспользоваться командой:
``` bash
make clean
```

## Задание
1) Реализовать 2 программы, первая сервер, вторая клиент. Сервер создает очередь сообщений и записывает сообщение виде строки “Hi!”, ждет ответа от клиента и выводит на экран, удаляет очередь. Клиент подключается к очереди считывает сообщение от сервера, выводит на экран, отвечает серверу сообщением виде строки “Hello!”. Сделать это как для POSIX, так и для SYSTEM V стандартов.
2) Написать 2 программы, первая сервер, вторая клиент. Сервер создает очередь сообщений для реализации чата с общей комнатой (если необходимо, то можно и больше очередей создать) и его задача уведомлять клиентов о появлении новых участников, о новых сообщениях. Клиент подключается к очереди, созданной сервером, сообщает ему свое имя и получает в ответ все сообщения в комнате. Далее может отправлять сообщения в общий чат. Получение служебных сообщений от сервера (имена новых клиентов, сообщения от других пользователей) и отправка сообщений в чат лучше реализовать в разных потоках. Интерфейс клиента реализуем с помощью библиотеки ncurses.

## Особенности реализации
### Клиент
В клиентском приложении на этапе отрисовки интерфейса было принято решения максимально использовать модульность. В результате анализа пользовательского интерфейса были выявлены основные блоки из которых он состоит:
- Список (listbox, элемент содержащий в себе список строк, выводимых на экран)
- Поле ввода (input_field, элемент предназначеный для считывания ввода пользователя в строку)
Во время разработки программного интерфейса были реализован модули listbox, input_field и обертки над ними, которые добавляют к ним логику чата: chat_window, users_window.

### Сервер
На этапе разработки сервера было принято решения визуализации процессов общения клиента и сервера в виде схемы, на которой будет показан поток данных от кклиента к серверу и обратно, а также потоки и отведенные под них задач:

На схеме можно видеть, что в каждом из запросов присутствует payload(полезная нагрузка сообщения). Она реализуется структурами user_request, message_request, её задача переопределить данные передаваемые между клиентом и сервером без необходимости переписывания большого количества кода в отправке запроса. Все запросы находятся в папке `requests`.

Также на этапе кодирования сервера было решено вынести конфигурацию в отдельный заголовочный файл, без её дублирования в других файлов. 

## Демонстрация работы программ
### Задание №1

### Задание №2

# TODO-LIST
## Server
- [x] Memory allocation for messages and users
- [x] Check exceptional situations
- [x] Notify users about new message
- [x] Notify users about new user
- [x] Send messages to new user
- [x] Send users to new user
- [x] Config file
- [x] Test server
- [x] Handle interruption signal to close thread and free memory
- [x] Add mutex to users and messages
## Client
- [x] Add log in
- [x] Refresh input field on ENTER
- [x] Input username before starting chat
- [x] Add labels to windows
- [x] Add handler for message
- [x] Add handler for users
- [x] Add send message function
- [x] Add threads
- [x] Config file
